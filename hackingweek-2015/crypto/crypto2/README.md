# HackingWeek CTF 2015: Crypto2

**Category:** Crypto |
**Points:** 5848 |
**Solves:** 19 |
**Description:**

> Bob utilise une clef publique RSA avec l'exposant public e = 65537 et le module:<br><br>
> ```
> N = 55089599753625499150129246679078411260946554356961748980861372828434789664694269460953507615455541204658984798121874916511031276020889949113155608279765385693784204971246654484161179832345357692487854383961212865469152326807704510472371156179457167612793412416133943976901478047318514990960333355366785001217
>```
>
> La clef de validation de l'épreuve est donnée par le `md5sum` de la valeur de sa clef privée `d`.
>

___

## Write-up

This challenge was quite simple.
We have to factorize N, and we have to found a good and quickly method.<br>
I have though to fermat, and I have used sage.
<br><br>
_fermat factorization function_ :

```python
sage: def fermatfactor(N):
           if N <= 0: return [N]
           if is_even(N): return [2,N/2]
           a = ceil(sqrt(N))
           while not is_square(a^2-N):
                 a = a + 1
           b = sqrt(a^2-N)
           return [a - b,a + b]
....:
```
<br>

_N_ :

```python
sage: N = 5508959975362549915012924667907841126094655435696174898086137282843
79765385693784204971246654484161179832345357692487854383961212865469152326807
1217
```
<br>

_print the result_ :
```python
sage: print fermatfactor(N)
[7422236843002619998657542152935407597465626963556444983366482781089760759017
26605114751241363894917330639701180033134442415868230443995865298299493927642
7, 74222368430026199986575421529354075974656269635564449833664827810897607609
14403641211700959458736191688739694068306773186013683526913015038631710959988
771]
```
<br>
At this point, I had `p * q`, which is `N`.<br>
`N = p * q`

With `p, q and e`, I can found `d`.

```bash
$ p=7422236843002619998657542152935407597465626963556444983366482781089760759017266051147512413638949173306397011800331344424158682304439958652982994939276427
$ q=7422236843002619998657542152935407597465626963556444983366482781089760760914403641211700959458736191688739694068306773186013683526913015038631710959988771
$ e=65537
$ python rsa.py -p$p -q$q -e$e --search d

d = 23064887432133452418944968485393480424632078139076757103405026306352475603240094293896627789805523522813645480807271096237944782073289886838211647399003341787604426963520708394682398410522699177647706339791627975491188337143684005336934914780236824919338821455517142365700147254540590602906990901658514178413
```
<br>
Pwned.

__Flag__: `<the value of d>`

Enjoy.<br>
\- [Notfound](http://www.notfound.ovh)
